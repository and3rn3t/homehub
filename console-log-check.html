<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Console Log Check - HomeHub</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        padding: 40px 20px;
        min-height: 100vh;
      }

      .container {
        max-width: 800px;
        margin: 0 auto;
        background: white;
        border-radius: 20px;
        padding: 40px;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
      }

      h1 {
        font-size: 32px;
        font-weight: 700;
        color: #1a202c;
        margin-bottom: 12px;
      }

      .subtitle {
        color: #718096;
        margin-bottom: 32px;
        font-size: 16px;
      }

      .alert {
        padding: 20px;
        border-radius: 12px;
        margin-bottom: 24px;
        border-left: 4px solid;
      }

      .alert-error {
        background: #fed7d7;
        border-color: #f56565;
        color: #742a2a;
      }

      .alert-info {
        background: #bee3f8;
        border-color: #4299e1;
        color: #2c5282;
      }

      .code {
        background: #2d3748;
        color: #68d391;
        padding: 16px;
        border-radius: 8px;
        font-family: 'Courier New', monospace;
        font-size: 13px;
        margin: 12px 0;
        white-space: pre-wrap;
      }

      .btn {
        width: 100%;
        padding: 20px;
        border: none;
        border-radius: 12px;
        font-weight: 700;
        font-size: 18px;
        cursor: pointer;
        transition: all 0.3s;
        margin-bottom: 12px;
      }

      .btn-primary {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
      }

      .btn-primary:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(102, 126, 234, 0.6);
      }

      textarea {
        width: 100%;
        min-height: 200px;
        padding: 16px;
        border: 2px solid #e2e8f0;
        border-radius: 8px;
        font-family: 'Courier New', monospace;
        font-size: 13px;
        resize: vertical;
      }

      label {
        display: block;
        font-weight: 600;
        color: #2d3748;
        margin-bottom: 8px;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>üìã Console Log Check</h1>
      <p class="subtitle">Copy the console output from Dashboard so I can diagnose</p>

      <div class="alert alert-info">
        <strong>üìù Instructions:</strong><br /><br />
        1. Go to Dashboard tab (http://localhost:5173)<br />
        2. Press <strong>F12</strong> to open DevTools<br />
        3. Click the <strong>Console</strong> tab<br />
        4. Find the line that says: <code>üîç Dashboard Favorites Debug:</code><br />
        5. Click the arrow to expand it<br />
        6. Copy the ENTIRE output and paste it in the box below<br />
        7. Click "Analyze" button
      </div>

      <label>Paste Dashboard Console Output Here:</label>
      <textarea
        id="consoleInput"
        placeholder="Paste the output from: üîç Dashboard Favorites Debug: {...}

It should look like:
{
  favoriteDevices (from useKV): Array(5) ['hue-39', 'hue-55', ...],
  devices count: 22,
  device IDs (first 10): Array(10) ['hue-39', 'hue-55', ...],
  favoriteDeviceList count: 5,
  favoriteDeviceList: Array(5) [{...}, {...}]
}"
      ></textarea>

      <button class="btn btn-primary" onclick="analyze()">üîç Analyze Console Output</button>

      <div id="results"></div>
    </div>

    <script>
      function analyze() {
        const input = document.getElementById('consoleInput').value
        const results = document.getElementById('results')

        if (!input.trim()) {
          results.innerHTML = `
                    <div class="alert alert-error">
                        ‚ùå Please paste the console output first!
                    </div>
                `
          return
        }

        let html = '<div style="margin-top: 24px;">'

        // Parse the input
        const favoriteDevicesMatch = input.match(/favoriteDevices[^:]*:\s*Array\((\d+)\)/)
        const devicesCountMatch = input.match(/devices count:\s*(\d+)/)
        const favoriteDeviceListMatch = input.match(/favoriteDeviceList count:\s*(\d+)/)

        const favoriteDevicesCount = favoriteDevicesMatch ? parseInt(favoriteDevicesMatch[1]) : null
        const devicesCount = devicesCountMatch ? parseInt(devicesCountMatch[1]) : null
        const favoriteDeviceListCount = favoriteDeviceListMatch
          ? parseInt(favoriteDeviceListMatch[1])
          : null

        html += '<div class="alert alert-info">'
        html += '<strong>üìä Parsed Values:</strong><br><br>'
        html +=
          'favoriteDevices: ' +
          (favoriteDevicesCount !== null ? favoriteDevicesCount + ' items' : 'Not found') +
          '<br>'
        html +=
          'devices count: ' +
          (devicesCount !== null ? devicesCount + ' items' : 'Not found') +
          '<br>'
        html +=
          'favoriteDeviceList count: ' +
          (favoriteDeviceListCount !== null ? favoriteDeviceListCount + ' items' : 'Not found')
        html += '</div>'

        // Diagnosis
        html += '<div class="alert alert-'

        if (
          favoriteDeviceListCount === null ||
          devicesCount === null ||
          favoriteDevicesCount === null
        ) {
          html +=
            'error"><strong>‚ùå Can\'t parse the output!</strong><br><br>Make sure you copied the FULL console output including all the braces and values.'
        } else if (devicesCount === 0) {
          html +=
            'error"><strong>‚ùå No devices loaded!</strong><br><br>The devices array is empty. The devices might not be loaded yet, or there\'s an issue with device loading.'
        } else if (favoriteDevicesCount === 0) {
          html +=
            'error"><strong>‚ùå favoriteDevices is empty!</strong><br><br>useKV is returning an empty array for favorite-devices. The localStorage might not be read correctly.'
        } else if (favoriteDeviceListCount === 0 && favoriteDevicesCount > 0) {
          html +=
            'error"><strong>‚ùå ID MISMATCH!</strong><br><br>favoriteDevices has ' +
            favoriteDevicesCount +
            " items, but favoriteDeviceList is 0. This means the favorite IDs don't match any device IDs.<br><br>Look in the console for device IDs and see if they match the favorite IDs."
        } else if (favoriteDeviceListCount > 0) {
          html +=
            'error"><strong>üò± WAIT... IT SHOULD BE WORKING!</strong><br><br>favoriteDeviceList has ' +
            favoriteDeviceListCount +
            " items! If favorites aren't showing in the UI, then the rendering code has a problem, not the data!<br><br>Check if there are any React errors in the console."
        } else {
          html +=
            'error"><strong>‚ùì Unclear issue</strong><br><br>Please send me the full console output so I can see what\'s happening.'
        }

        html += '</div></div>'

        results.innerHTML = html
      }
    </script>
  </body>
</html>
